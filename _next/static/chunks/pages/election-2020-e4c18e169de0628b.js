(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[130],{9746:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/election-2020",function(){return l(5150)}])},5150:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return L}});var a=l(5893),n=l(5582),i=l(9008),s=l.n(i),r=l(7294);let d=e=>{let{children:t,title:l}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s(),{children:[(0,a.jsx)("title",{children:l}),(0,a.jsx)("meta",{name:"description",content:"Kevin Riste's GitHub Pages site"}),(0,a.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,a.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,a.jsx)("main",{children:(0,a.jsx)(n.Z,{maxWidth:"xl",sx:{height:"90vh"},children:t})})]})};var o=l(1426),c=l(3321),x=l(913),h=l(3841),u=l(5914),p=l(7918),m=l(9840),f=l(5071),j=l(9334),g=l(1903),y=l(1664),Z=l.n(y),v=l(3148);l(4502);var b=l(5430),C=l(9591),w=l.n(C),D=l(6180),k=l(8433);let S=()=>({responsive:!0,aspectRatio:1,plugins:{legend:{labels:{filter:e=>"polls"!==e.text.slice(-5)}}},scales:{x:{bounds:"data",type:"time",distribution:"linear",time:{round:"day",unit:"month"},ticks:{autoSkip:!1},grid:{offset:!1}},y:{max:.75,min:.25,ticks:{callback:e=>"string"==typeof e?e:e.toLocaleString("en-US",{style:"percent"})}}}}),P=(e,t,l,a,n,i)=>e.filter(e=>t.includes(e.label)).map(e=>({type:"scatter",label:e.label,backgroundColor:l[e.label].light,borderColor:l[e.label].light,data:e.data.filter(e=>a.includes(e.state)).filter(e=>(!n[0]||T(n[0],e.x)>=0)&&(!n[1]||T(e.x,n[1])>=0)).map(e=>({x:e.x,y:e.y})).concat(i),fill:!0,showLine:!1})),M=(e,t,l,a,n,i,s)=>{if("off"===e)return[];{let r=t.find(t=>t.decayFactor===a&&t.stateSetDescription===e);return r?r.lineChartData.filter(e=>n.includes(e.label)).map(e=>({type:"scatter",label:e.label+"polls",backgroundColor:l[e.label].dark,borderColor:l[e.label].dark,data:e.data.filter(e=>(!i[0]||T(i[0],e.x)>=0)&&(!i[1]||T(e.x,i[1])>=0)).map(e=>({x:e.x,y:e.y})).concat(s),fill:!1,showLine:!0,pointRadius:0})):[]}},T=(e,t)=>{let l=0;return e&&t&&(l=Math.floor((new Date(t).getTime()-new Date(e).getTime())/864e5)),l};var _=l(2359),E=l(6351),F=l(6437),H=l(5418);v.kL.register(v.Gu,v.De,v.uw,v.f$,v.jn,v.od,v.ho,v.FB,v.u);let N=()=>{let e={Biden:{light:"hsl(214, 51.72%, 80%)",dark:"hsl(214, 51.72%, 40%)"},Trump:{light:"hsl(328.49, 98.35%, 80%)",dark:"hsl(328.49, 98.35%, 40%)"}},[t,l]=r.useState(["Biden","Trump"]),[n,i]=r.useState([""]),[s,y]=r.useState("National Polls"),[v,C]=r.useState([null,null]),N=async e=>{let t=await (0,k.Z)({method:"get",url:e}),l=JSON.parse(w().inflate(t.data,{to:"string"}));return l.initialDate=new Date(l.availableDates[0]||""),l.finalDate=new Date(l.availableDates.slice(-1)[0]||""),l},{data:L,error:I,isLoading:O}=(0,D.Z)("https://kr-latest-primary-polls-processed.s3.us-east-2.amazonaws.com/latest.json.gz",N);I||O||null!==v[0]||null!==v[1]||C([new Date("May 01 2019 00:00:00 GMT-0500 (Central Daylight Time)"),(null==L?void 0:L.finalDate)||null]),null==L||L.initialDate,null==L||L.finalDate;let R=(null==L?void 0:L.availableCandidates.filter(e=>!(T(v[1],e.minDate)>=0)&&!(T(e.maxDate,v[0])>=0)).map(e=>e.candidate))||[],A=(null==L?void 0:L.availableStates.filter(e=>!(T(v[1],e.minDate)>=0)&&!(T(e.maxDate,v[0])>=0)).map(e=>e.state))||[],B=[{x:v[0],y:null},{x:v[1],y:null}],G=M(s,(null==L?void 0:L.lineChartsForEachCandidate)||[],e,7,t,v,B),W=P((null==L?void 0:L.scatterPlotSeriesForEachCandidate)||[],t,e,n,v,B),U={datasets:[...G,...W]},Y=e=>{C([e,v[1]])},z=e=>{C([v[0],e])},K=e=>{let t=e.target.value;y(t)},V=e=>{let{target:{value:t}}=e;l("string"==typeof t?t.split(","):t)},X=e=>{let{target:{value:t}}=e;i("string"==typeof t?t.split(","):t)},J=()=>{l(["Biden","Trump"]),i([""]),C([new Date("May 01 2019 00:00:00 GMT-0500 (Central Daylight Time)"),(null==L?void 0:L.finalDate)||null])};r.useEffect(()=>{let e="off";1===n.length?""===n[0]?e="National Polls":((null==L?void 0:L.lineChartsForEachCandidate)||[]).map(e=>e.stateSetDescription).includes("".concat(n[0]," Polls"))&&(e="".concat(n[0]," Polls")):n.length===A.length&&(e="All Polls"),y(e)},[n,null==L?void 0:L.lineChartsForEachCandidate,A.length]);let $=S();return(0,a.jsx)(d,{title:"Kevin Riste - 2020 Election",children:(0,a.jsxs)(o.Z,{children:[(0,a.jsx)(o.Z,{container:!0,spacing:2,sx:{marginY:2},display:"flex",justifyContent:"center",alignItems:"center",children:(0,a.jsx)(o.Z,{children:(0,a.jsx)(c.Z,{href:"/",variant:"outlined",component:Z(),sx:{textTransform:"none"},children:"Home"})})}),!I&&!O&&(0,a.jsxs)(o.Z,{container:!0,children:[(0,a.jsx)(o.Z,{xs:12,display:"flex",justifyContent:"center",alignItems:"center",children:(0,a.jsx)(b.kL,{type:"bar",data:U,options:$,style:{maxHeight:400,maxWidth:400}})}),(0,a.jsxs)(o.Z,{xs:12,sx:{marginY:2},container:!0,spacing:2,display:"flex",justifyContent:"center",children:[(0,a.jsx)(o.Z,{children:(0,a.jsxs)(x.Z,{sx:{width:200},children:[(0,a.jsx)(h.Z,{children:"States"}),(0,a.jsx)(u.Z,{multiple:!0,value:n,onChange:X,label:"States",MenuProps:{PaperProps:{sx:{maxHeight:400}}},renderValue:e=>(0,a.jsx)(H.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map(e=>{let t=""===e?"U.S.":e;return(0,a.jsx)(p.Z,{label:t},t)})}),children:A.map(e=>{let t=""===e?"U.S.":e;return(0,a.jsxs)(m.Z,{value:e,children:[(0,a.jsx)(f.Z,{checked:n.includes(e)}),(0,a.jsx)(j.Z,{primary:t})]},t)})})]})}),(0,a.jsx)(o.Z,{children:(0,a.jsxs)(x.Z,{sx:{width:200},children:[(0,a.jsx)(h.Z,{children:"Candidates"}),(0,a.jsx)(u.Z,{multiple:!0,value:t,onChange:V,label:"Candidates",MenuProps:{PaperProps:{sx:{maxHeight:400}}},renderValue:e=>(0,a.jsx)(H.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.sort().map(e=>(0,a.jsx)(p.Z,{label:e},e))}),children:R.map(e=>(0,a.jsxs)(m.Z,{value:e,children:[(0,a.jsx)(f.Z,{checked:t.includes(e)}),(0,a.jsx)(j.Z,{primary:e})]},e))})]})}),(0,a.jsx)(o.Z,{children:(0,a.jsxs)(x.Z,{sx:{width:200},children:[(0,a.jsx)(h.Z,{children:"Average Lines"}),(0,a.jsxs)(u.Z,{value:s,label:"Average Lines",onChange:K,MenuProps:{PaperProps:{sx:{maxHeight:400}}},sx:{minHeight:65},children:[null==L?void 0:L.lineChartsForEachCandidate.map(e=>(0,a.jsx)(m.Z,{value:e.stateSetDescription,children:e.stateSetDescription},e.stateSetDescription)),(0,a.jsx)(m.Z,{value:"off",children:"Off"})]})]})})]}),(0,a.jsx)(o.Z,{xs:12,container:!0,spacing:2,justifyContent:"center",alignItems:"center",children:(0,a.jsxs)(_._,{dateAdapter:F.H,children:[(0,a.jsx)(o.Z,{children:(0,a.jsx)(E.O,{label:"From",inputFormat:"yyyy-MMM-dd",value:v[0],onChange:Y,renderInput:e=>(0,a.jsx)(g.Z,{sx:{width:200},...e})})}),(0,a.jsx)(o.Z,{children:(0,a.jsx)(E.O,{label:"To",inputFormat:"yyyy-MMM-dd",value:v[1],onChange:z,renderInput:e=>(0,a.jsx)(g.Z,{sx:{width:200},...e})})})]})}),(0,a.jsx)(o.Z,{xs:12,container:!0,spacing:2,sx:{marginY:2},display:"flex",justifyContent:"center",alignItems:"center",children:(0,a.jsx)(o.Z,{children:(0,a.jsx)(c.Z,{variant:"outlined",onClick:J,sx:{textTransform:"none"},children:"Reset"})})})]})]})})};var L=N}},function(e){e.O(0,[196,410,380,774,888,179],function(){return e(e.s=9746)}),_N_E=e.O()}]);