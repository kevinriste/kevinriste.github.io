(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{334:function(t,e,n){var map={"./af":189,"./af.js":189,"./ar":190,"./ar-dz":191,"./ar-dz.js":191,"./ar-kw":192,"./ar-kw.js":192,"./ar-ly":193,"./ar-ly.js":193,"./ar-ma":194,"./ar-ma.js":194,"./ar-sa":195,"./ar-sa.js":195,"./ar-tn":196,"./ar-tn.js":196,"./ar.js":190,"./az":197,"./az.js":197,"./be":198,"./be.js":198,"./bg":199,"./bg.js":199,"./bm":200,"./bm.js":200,"./bn":201,"./bn.js":201,"./bo":202,"./bo.js":202,"./br":203,"./br.js":203,"./bs":204,"./bs.js":204,"./ca":205,"./ca.js":205,"./cs":206,"./cs.js":206,"./cv":207,"./cv.js":207,"./cy":208,"./cy.js":208,"./da":209,"./da.js":209,"./de":210,"./de-at":211,"./de-at.js":211,"./de-ch":212,"./de-ch.js":212,"./de.js":210,"./dv":213,"./dv.js":213,"./el":214,"./el.js":214,"./en-SG":215,"./en-SG.js":215,"./en-au":216,"./en-au.js":216,"./en-ca":217,"./en-ca.js":217,"./en-gb":218,"./en-gb.js":218,"./en-ie":219,"./en-ie.js":219,"./en-il":220,"./en-il.js":220,"./en-nz":221,"./en-nz.js":221,"./eo":222,"./eo.js":222,"./es":223,"./es-do":224,"./es-do.js":224,"./es-us":225,"./es-us.js":225,"./es.js":223,"./et":226,"./et.js":226,"./eu":227,"./eu.js":227,"./fa":228,"./fa.js":228,"./fi":229,"./fi.js":229,"./fo":230,"./fo.js":230,"./fr":231,"./fr-ca":232,"./fr-ca.js":232,"./fr-ch":233,"./fr-ch.js":233,"./fr.js":231,"./fy":234,"./fy.js":234,"./ga":235,"./ga.js":235,"./gd":236,"./gd.js":236,"./gl":237,"./gl.js":237,"./gom-latn":238,"./gom-latn.js":238,"./gu":239,"./gu.js":239,"./he":240,"./he.js":240,"./hi":241,"./hi.js":241,"./hr":242,"./hr.js":242,"./hu":243,"./hu.js":243,"./hy-am":244,"./hy-am.js":244,"./id":245,"./id.js":245,"./is":246,"./is.js":246,"./it":247,"./it-ch":248,"./it-ch.js":248,"./it.js":247,"./ja":249,"./ja.js":249,"./jv":250,"./jv.js":250,"./ka":251,"./ka.js":251,"./kk":252,"./kk.js":252,"./km":253,"./km.js":253,"./kn":254,"./kn.js":254,"./ko":255,"./ko.js":255,"./ku":256,"./ku.js":256,"./ky":257,"./ky.js":257,"./lb":258,"./lb.js":258,"./lo":259,"./lo.js":259,"./lt":260,"./lt.js":260,"./lv":261,"./lv.js":261,"./me":262,"./me.js":262,"./mi":263,"./mi.js":263,"./mk":264,"./mk.js":264,"./ml":265,"./ml.js":265,"./mn":266,"./mn.js":266,"./mr":267,"./mr.js":267,"./ms":268,"./ms-my":269,"./ms-my.js":269,"./ms.js":268,"./mt":270,"./mt.js":270,"./my":271,"./my.js":271,"./nb":272,"./nb.js":272,"./ne":273,"./ne.js":273,"./nl":274,"./nl-be":275,"./nl-be.js":275,"./nl.js":274,"./nn":276,"./nn.js":276,"./pa-in":277,"./pa-in.js":277,"./pl":278,"./pl.js":278,"./pt":279,"./pt-br":280,"./pt-br.js":280,"./pt.js":279,"./ro":281,"./ro.js":281,"./ru":282,"./ru.js":282,"./sd":283,"./sd.js":283,"./se":284,"./se.js":284,"./si":285,"./si.js":285,"./sk":286,"./sk.js":286,"./sl":287,"./sl.js":287,"./sq":288,"./sq.js":288,"./sr":289,"./sr-cyrl":290,"./sr-cyrl.js":290,"./sr.js":289,"./ss":291,"./ss.js":291,"./sv":292,"./sv.js":292,"./sw":293,"./sw.js":293,"./ta":294,"./ta.js":294,"./te":295,"./te.js":295,"./tet":296,"./tet.js":296,"./tg":297,"./tg.js":297,"./th":298,"./th.js":298,"./tl-ph":299,"./tl-ph.js":299,"./tlh":300,"./tlh.js":300,"./tr":301,"./tr.js":301,"./tzl":302,"./tzl.js":302,"./tzm":303,"./tzm-latn":304,"./tzm-latn.js":304,"./tzm.js":303,"./ug-cn":305,"./ug-cn.js":305,"./uk":306,"./uk.js":306,"./ur":307,"./ur.js":307,"./uz":308,"./uz-latn":309,"./uz-latn.js":309,"./uz.js":308,"./vi":310,"./vi.js":310,"./x-pseudo":311,"./x-pseudo.js":311,"./yo":312,"./yo.js":312,"./zh-cn":313,"./zh-cn.js":313,"./zh-hk":314,"./zh-hk.js":314,"./zh-tw":315,"./zh-tw.js":315};function r(t){var e=l(t);return n(e)}function l(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}r.keys=function(){return Object.keys(map)},r.resolve=l,t.exports=r,r.id=334},341:function(t,e,n){"use strict";n.r(e);n(318),n(319),n(58);var r,l=n(8),o=(n(322),n(324),n(56),n(24),n(25),n(14),n(70),n(328),n(339)),c=(n(73),n(75),n(331)),d=n(340),h=d.b.reactiveProp,f={extends:d.a,mixins:[h],props:{options:{type:Object,default:function(){}}},mounted:function(){this.renderChart(this.chartData,this.options)}},j=n(13),m={components:{BarChart:Object(j.a)(f,void 0,void 0,!1,null,null,null).exports},layout:"fullpage",data:function(){return{colors:{},availableDateRange:[null,null],dateRange:[null,null],availableDecayFactors:[1,3,7,10,14],fiveThirtyEightDataset:[],minWeight:.05,pollsterRatings:[],jsonURL:"",pollstersURL:"",globalAverage:2.341782,decayFactor:7,selectedStates:[""],scatterChartData:{},lineChartData:{},selectedCandidates:[],weightedDataURL:""}},computed:{chartOptions:function(){return{responsive:!0,maintainAspectRatio:!1,legend:{labels:{filter:function(t,e){return t.fillStyle.includes("40%)")}}},scales:{xAxes:[{type:"time",distribution:"linear",time:{round:"day"}}],yAxes:[{ticks:{suggestedMin:0,suggestedMax:.5}}]}}},topCandidates:function(){var t=this;return this.selectedCandidates.map(function(a,e){return{answer:a.answer,color:t.colors[a.answer]}})},availableStates:function(){var t=Object(o.a)(new Set(this.pollsMapped.filter(function(a){return"Biden"==a.answer}).map(function(a){return a.question_id}))),e=this.pollsMapped.filter(function(a){return"DEM"==a.party&&t.includes(a.question_id)});return Object(o.a)(new Set(e.map(function(a){return a.state}))).sort()},availableDates:function(){for(var t=[],dt=new Date(Math.min.apply(Math,Object(o.a)(this.bidenPollsOnly.map(function(a){return a.medianDate})))),e=new Date(Math.max.apply(Math,Object(o.a)(this.bidenPollsOnly.map(function(a){return a.medianDate}))));dt<=e;)t.push(new Date(dt)),dt.setDate(dt.getDate()+1);return t.push(new Date(dt)),t.map(function(a){return new Date(a).toLocaleDateString()})},bidenPollsOnly:function(){var t=this,e=Object(o.a)(new Set(this.pollsMapped.filter(function(a){return"Biden"==a.answer}).map(function(a){return a.question_id}))),n=this.pollsMapped.filter(function(a){return"DEM"==a.party&&t.topCandidates.map(function(a){return a.answer}).includes(a.answer)&&e.includes(a.question_id)});return n},bidenPollsOnlyStateFiltered:function(){var t=this;return this.bidenPollsOnly.filter(function(a){return t.selectedStates.includes(a.state)})},availableCandidates:function(){var t=this,e=Object(o.a)(new Set(this.pollsMapped.filter(function(a){return"Biden"==a.answer}).map(function(a){return a.question_id}))),n=this.pollsMapped.filter(function(a){return"DEM"==a.party&&e.includes(a.question_id)}),r=Object(o.a)(new Set(n.map(function(a){return a.answer})));r=r.map(function(a){return{answer:a,total:0,count:0,avg:0}});var l=!0,c=!1,d=void 0;try{for(var h,f=function(){var e=h.value;n.filter(function(a){return a.answer==e.answer&&t.dateDiff(a.medianDate,new Date)<14}).forEach(function(a){e.total+=a.pct,e.count+=1,e.avg=e.total/e.count})},j=r[Symbol.iterator]();!(l=(h=j.next()).done);l=!0)f()}catch(t){c=!0,d=t}finally{try{l||null==j.return||j.return()}finally{if(c)throw d}}return r.sort(function(a,b){return b.avg-a.avg})},pollsMapped:function(){var t=this;return this.fiveThirtyEightDataset.filter(function(a){return"open-ended question"!=a.notes&&"head-to-head poll"!=a.notes}).map(function(a){var e=new Date(a.start_date).getTime()+(new Date(a.end_date).getTime()-new Date(a.start_date).getTime())/2,n=1.96*Math.sqrt(a.pct/100*(1-a.pct/100)/a.sample_size)*100,r=t.pollsterRatings.find(function(b){return b.Pollster==a.pollster}),l=6400*(-2^n+(t.globalAverage+!r?0:r["Predictive Plus-Minus"]))/(6400*(-2^n+t.globalAverage));return{answer:a.answer,pct:t.round(a.pct/100,4),state:a.state,question_id:a.question_id,medianDate:new Date(e),pollWeight:l,party:a.party}})},pollScatter:function(){var t=this,e=[],n=!0,r=!1,l=void 0;try{for(var o,c=function(){var n=o.value;e.push({type:"scatter",label:n.answer,backgroundColor:n.color.light,borderColor:n.color.light,data:t.bidenPollsOnly.filter(function(a){return a.answer==n.answer}).map(function(a){return{x:a.medianDate,y:t.selectedStates.includes(a.state)?a.pct:null}}),fill:!1,showLine:!1})},d=this.topCandidates[Symbol.iterator]();!(n=(o=d.next()).done);n=!0)c()}catch(t){r=!0,l=t}finally{try{n||null==d.return||d.return()}finally{if(r)throw l}}return{datasets:e}},pollsWeighted:function(){for(var t=[],dt=new Date(Math.min.apply(Math,Object(o.a)(this.bidenPollsOnly.map(function(a){return a.medianDate})))),e=new Date(Math.max.apply(Math,Object(o.a)(this.bidenPollsOnly.map(function(a){return a.medianDate}))));dt<=e;)t.push(new Date(dt)),dt.setDate(dt.getDate()+1);t.push(new Date(dt));for(var n={},r=0,l=t;r<l.length;r++){var c=l[r],d=!0,h=!1,f=void 0;try{for(var j,m=this.topCandidates[Symbol.iterator]();!(d=(j=m.next()).done);d=!0){var v=j.value;n[v.answer]||(n[v.answer]={}),n[v.answer][c]={netPct:0,netWt:0,date:c}}}catch(t){h=!0,f=t}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}var y=!0,w=!1,D=void 0;try{for(var k,C=this.bidenPollsOnlyStateFiltered[Symbol.iterator]();!(y=(k=C.next()).done);y=!0){var S=k.value,R=Math.floor((c-S.medianDate)/864e5),x=Math.pow(.5,R/this.decayFactor)*S.pollWeight;x=x<this.minWeight?0:x,x=R<0?0:x,n[S.answer][c].netPct+=x*S.pct,n[S.answer][c].netWt+=x}}catch(t){w=!0,D=t}finally{try{y||null==C.return||C.return()}finally{if(w)throw D}}}this.setWeightedDataURL(window.URL.createObjectURL(new Blob([JSON.stringify(n)],{type:"application/json"})));var M=[],O=!0,_=!1,z=void 0;try{for(var P,W=this.topCandidates[Symbol.iterator]();!(O=(P=W.next()).done);O=!0){var F=P.value;M.push({type:"scatter",label:F.answer,backgroundColor:F.color.dark,borderColor:F.color.dark,data:Object.values(n[F.answer]).map(function(a){return{x:a.date,y:0==a.netWt||0==a.netPct?null:a.netPct/a.netWt}}),pointRadius:0,fill:!1})}}catch(t){_=!0,z=t}finally{try{O||null==W.return||W.return()}finally{if(_)throw z}}return{datasets:M}},pollsScatterAndWeighted:function(){return{datasets:this.pollsWeighted.datasets.concat(this.pollScatter.datasets)}},pollsScatterAndWeightedDateFiltered:function(){var t=this,e=JSON.parse(JSON.stringify(this.pollsScatterAndWeighted));return e.datasets.forEach(function(a){a.data=a.data.filter(function(b){return(!t.dateRange[0]||t.dateDiff(t.dateRange[0],b.x)>=0)&&(!t.dateRange[1]||t.dateDiff(b.x,t.dateRange[1])>=0)})}),e}},asyncData:(r=Object(l.a)(regeneratorRuntime.mark(function t(e){var n,r,l,o,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$axios,t.next=3,n({method:"get",url:"https://warm-lake-79107.herokuapp.com/https://projects.fivethirtyeight.com/polls-page/president_primary_polls.csv"});case 3:return r=t.sent,t.next=6,c().fromString(r.data);case 6:return l=t.sent,t.next=9,n({method:"get",url:"https://warm-lake-79107.herokuapp.com/https://raw.githubusercontent.com/fivethirtyeight/data/master/pollster-ratings/pollster-ratings.csv"});case 9:return o=t.sent,t.next=12,c().fromString(o.data);case 12:return d=t.sent,t.abrupt("return",{fiveThirtyEightDataset:l,pollsterRatings:d});case 14:case"end":return t.stop()}},t)})),function(t){return r.apply(this,arguments)}),mounted:function(){console.log("mount0"),this.setColors(),this.selectedCandidates=this.availableCandidates.slice(0,5),this.dateRange=[new Date(this.availableDates[0]),new Date(this.availableDates.slice(-1)[0])],this.availableDateRange=Object.assign({},this.dateRange),this.dateRange[0]=new Date("May 01 2019 00:00:00 GMT-0500 (Central Daylight Time)"),this.selectedStates=this.availableStates,console.log(this.availableDateRange[0]),console.log(this.dateRange[1]),console.log("mount1")},methods:{setColors:function(){var t=this,e=this.generateHslColors(this.availableCandidates.length);this.availableCandidates.forEach(function(a){return t.colors[a.answer]=e.shift()})},dateDiff:function(t,e){return Math.floor((new Date(e)-new Date(t))/864e5)},shuffleArray:function(t){for(var i=t.length-1;i>0;i--){var e=Math.floor(Math.random()*(i+1)),n=[t[e],t[i]];t[i]=n[0],t[e]=n[1]}return t},setWeightedDataURL:function(t){this.weightedDataURL=t},randomVal:function(t,e){return Math.floor(Math.random()*(e-t)+1)+t},round:function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)},generateHslColors:function(t){for(var e=[],n=Math.trunc(360/t),i=0;i<t-5;i++){var r=i*n,s=this.randomVal(30,95);e.push({light:"hsl(".concat(r,", ").concat(s,"%,  80%)"),dark:"hsl(".concat(r,", ").concat(s,"%,  40%)")})}return(e=this.shuffleArray(e)).unshift({light:"hsl(120, 40.66%,  80%)",dark:"hsl(120, 40.66%,  40%)"}),e.unshift({light:"hsl(305.38, 68.72%,  80%)",dark:"hsl(305.38, 68.72%,  40%)"}),e.unshift({light:"hsl(29.24, 96.75%,  80%)",dark:"hsl(29.24, 96.75%,  40%)"}),e.unshift({light:"hsl(214, 51.72%,  80%)",dark:"hsl(214, 51.72%,  40%)"}),e.unshift({light:"hsl(328.49, 98.35%,  80%)",dark:"hsl(328.49, 98.35%,  40%)"}),e}}},v=Object(j.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"hero"},[n("section",{staticClass:"hero-body"},[n("div",{staticClass:"level"},[n("div",{staticClass:"level-item"},[n("nuxt-link",{staticClass:"button is-outlined is-primary",attrs:{to:"/"}},[t._v("\n          Home\n        ")])],1)]),t._v(" "),n("div",{staticClass:"columns is-multiline is-mobile is-centered"},[n("div",{staticClass:"column is-narrow"},[n("div",{staticClass:"level"},[n("bar-chart",{ref:"chart",attrs:{"chart-data":t.pollsScatterAndWeightedDateFiltered,options:t.chartOptions}})],1),t._v(" "),n("div",{staticClass:"level"},[n("div",{staticClass:"columns"},[n("div",{staticClass:"column is-narrow"},[n("b-field",{attrs:{label:"From"}},[n("b-datepicker",{attrs:{"min-date":t.availableDateRange[0],"max-date":t.dateRange[1]},model:{value:t.dateRange[0],callback:function(e){t.$set(t.dateRange,0,e)},expression:"dateRange[0]"}})],1)],1),t._v(" "),n("div",{staticClass:"column is-narrow"},[n("b-field",{attrs:{label:"To"}},[n("b-datepicker",{attrs:{"min-date":t.availableDateRange[0],"max-date":t.availableDateRange[1]},model:{value:t.dateRange[1],callback:function(e){t.$set(t.dateRange,1,e)},expression:"dateRange[1]"}})],1)],1)])])]),t._v(" "),n("div",{staticClass:"column is-narrow"},[n("div",{staticClass:"columns is-mobile"},[n("div",{staticClass:"column is-narrow"},[n("b-field",{attrs:{label:"States"}},[n("b-select",{staticClass:"is-small",attrs:{multiple:"","native-size":"6"},model:{value:t.selectedStates,callback:function(e){t.selectedStates=e},expression:"selectedStates"}},t._l(t.availableStates,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n                  "+t._s(""==e?"U.S.":e)+"\n                ")])}),0)],1),t._v(" "),n("b-field",{attrs:{label:"Half Life"}},[n("b-select",{staticClass:"is-small",model:{value:t.decayFactor,callback:function(e){t.decayFactor=e},expression:"decayFactor"}},t._l(t.availableDecayFactors,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n                  "+t._s(e)+"\n                ")])}),0)],1)],1),t._v(" "),n("div",{staticClass:"column is-narrow"},[n("b-field",{attrs:{label:"Candidates"}},[n("b-select",{staticClass:"is-small",attrs:{multiple:"","native-size":"10"},model:{value:t.selectedCandidates,callback:function(e){t.selectedCandidates=e},expression:"selectedCandidates"}},t._l(t.availableCandidates,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n                  "+t._s(e.answer)+"\n                ")])}),0)],1)],1)])])])])])},[],!1,null,null,null);e.default=v.exports}}]);