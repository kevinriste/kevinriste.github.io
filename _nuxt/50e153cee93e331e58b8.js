(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{332:function(t,e,n){var map={"./af":186,"./af.js":186,"./ar":187,"./ar-dz":188,"./ar-dz.js":188,"./ar-kw":189,"./ar-kw.js":189,"./ar-ly":190,"./ar-ly.js":190,"./ar-ma":191,"./ar-ma.js":191,"./ar-sa":192,"./ar-sa.js":192,"./ar-tn":193,"./ar-tn.js":193,"./ar.js":187,"./az":194,"./az.js":194,"./be":195,"./be.js":195,"./bg":196,"./bg.js":196,"./bm":197,"./bm.js":197,"./bn":198,"./bn.js":198,"./bo":199,"./bo.js":199,"./br":200,"./br.js":200,"./bs":201,"./bs.js":201,"./ca":202,"./ca.js":202,"./cs":203,"./cs.js":203,"./cv":204,"./cv.js":204,"./cy":205,"./cy.js":205,"./da":206,"./da.js":206,"./de":207,"./de-at":208,"./de-at.js":208,"./de-ch":209,"./de-ch.js":209,"./de.js":207,"./dv":210,"./dv.js":210,"./el":211,"./el.js":211,"./en-SG":212,"./en-SG.js":212,"./en-au":213,"./en-au.js":213,"./en-ca":214,"./en-ca.js":214,"./en-gb":215,"./en-gb.js":215,"./en-ie":216,"./en-ie.js":216,"./en-il":217,"./en-il.js":217,"./en-nz":218,"./en-nz.js":218,"./eo":219,"./eo.js":219,"./es":220,"./es-do":221,"./es-do.js":221,"./es-us":222,"./es-us.js":222,"./es.js":220,"./et":223,"./et.js":223,"./eu":224,"./eu.js":224,"./fa":225,"./fa.js":225,"./fi":226,"./fi.js":226,"./fo":227,"./fo.js":227,"./fr":228,"./fr-ca":229,"./fr-ca.js":229,"./fr-ch":230,"./fr-ch.js":230,"./fr.js":228,"./fy":231,"./fy.js":231,"./ga":232,"./ga.js":232,"./gd":233,"./gd.js":233,"./gl":234,"./gl.js":234,"./gom-latn":235,"./gom-latn.js":235,"./gu":236,"./gu.js":236,"./he":237,"./he.js":237,"./hi":238,"./hi.js":238,"./hr":239,"./hr.js":239,"./hu":240,"./hu.js":240,"./hy-am":241,"./hy-am.js":241,"./id":242,"./id.js":242,"./is":243,"./is.js":243,"./it":244,"./it-ch":245,"./it-ch.js":245,"./it.js":244,"./ja":246,"./ja.js":246,"./jv":247,"./jv.js":247,"./ka":248,"./ka.js":248,"./kk":249,"./kk.js":249,"./km":250,"./km.js":250,"./kn":251,"./kn.js":251,"./ko":252,"./ko.js":252,"./ku":253,"./ku.js":253,"./ky":254,"./ky.js":254,"./lb":255,"./lb.js":255,"./lo":256,"./lo.js":256,"./lt":257,"./lt.js":257,"./lv":258,"./lv.js":258,"./me":259,"./me.js":259,"./mi":260,"./mi.js":260,"./mk":261,"./mk.js":261,"./ml":262,"./ml.js":262,"./mn":263,"./mn.js":263,"./mr":264,"./mr.js":264,"./ms":265,"./ms-my":266,"./ms-my.js":266,"./ms.js":265,"./mt":267,"./mt.js":267,"./my":268,"./my.js":268,"./nb":269,"./nb.js":269,"./ne":270,"./ne.js":270,"./nl":271,"./nl-be":272,"./nl-be.js":272,"./nl.js":271,"./nn":273,"./nn.js":273,"./pa-in":274,"./pa-in.js":274,"./pl":275,"./pl.js":275,"./pt":276,"./pt-br":277,"./pt-br.js":277,"./pt.js":276,"./ro":278,"./ro.js":278,"./ru":279,"./ru.js":279,"./sd":280,"./sd.js":280,"./se":281,"./se.js":281,"./si":282,"./si.js":282,"./sk":283,"./sk.js":283,"./sl":284,"./sl.js":284,"./sq":285,"./sq.js":285,"./sr":286,"./sr-cyrl":287,"./sr-cyrl.js":287,"./sr.js":286,"./ss":288,"./ss.js":288,"./sv":289,"./sv.js":289,"./sw":290,"./sw.js":290,"./ta":291,"./ta.js":291,"./te":292,"./te.js":292,"./tet":293,"./tet.js":293,"./tg":294,"./tg.js":294,"./th":295,"./th.js":295,"./tl-ph":296,"./tl-ph.js":296,"./tlh":297,"./tlh.js":297,"./tr":298,"./tr.js":298,"./tzl":299,"./tzl.js":299,"./tzm":300,"./tzm-latn":301,"./tzm-latn.js":301,"./tzm.js":300,"./ug-cn":302,"./ug-cn.js":302,"./uk":303,"./uk.js":303,"./ur":304,"./ur.js":304,"./uz":305,"./uz-latn":306,"./uz-latn.js":306,"./uz.js":305,"./vi":307,"./vi.js":307,"./x-pseudo":308,"./x-pseudo.js":308,"./yo":309,"./yo.js":309,"./zh-cn":310,"./zh-cn.js":310,"./zh-hk":311,"./zh-hk.js":311,"./zh-tw":312,"./zh-tw.js":312};function r(t){var e=l(t);return n(e)}function l(t){if(!n.o(map,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return map[t]}r.keys=function(){return Object.keys(map)},r.resolve=l,t.exports=r,r.id=332},341:function(t,e,n){"use strict";n.r(e);n(315),n(316),n(54);var r=n(6),l=(n(319),n(321),n(51),n(52),n(37),n(24),n(67),n(325),n(339)),o=(n(71),n(73),n(328)),c=n(329),d=n.n(c),h=n(340),f=h.b.reactiveProp,j={extends:h.a,mixins:[f],props:{options:{type:Object,default:function(){}}},mounted:function(){this.renderChart(this.chartData,this.options)}},m=n(13),v=Object(m.a)(j,void 0,void 0,!1,null,null,null).exports,y=(n(333),{components:{BarChart:v,VueSlider:d.a},layout:"fullpage",data:function(){return{dateRange:[],availableMinWeights:[0,.05,.1,.15,.2,.25,.3,.35,.4,.45,.5],availableDecayFactors:[7,14,21,28,35,42],fiveThirtyEightDataset:[],minWeight:0,pollsterRatings:[],jsonURL:"",pollstersURL:"",globalAverage:2.341782,decayFactor:14,selectedStates:[""],scatterChartData:{},lineChartData:{},selectedCandidates:[],weightedDataURL:"",maybeMarks:function(t){return 1==new Date(t).getDate()&&{label:new Date(t).toLocaleString("en-us",{month:"short",year:"numeric"})}}}},computed:{chartOptions:function(){return{responsive:!0,maintainAspectRatio:!1,legend:{labels:{filter:function(t,e){return t.fillStyle.includes("40%)")}}},scales:{xAxes:[{type:"time",distribution:"linear",time:{round:"day"}}],yAxes:[{ticks:{suggestedMin:0,suggestedMax:.5}}]}}},topCandidates:function(){var t=this.shuffleArray(this.generateHslColors(this.selectedCandidates.length));return this.selectedCandidates.map(function(a,e){return{answer:a.answer,color:t[e]}})},availableStates:function(){var t=Object(l.a)(new Set(this.pollsMapped.filter(function(a){return"Biden"==a.answer}).map(function(a){return a.question_id}))),e=this.pollsMapped.filter(function(a){return"DEM"==a.party&&t.includes(a.question_id)});return Object(l.a)(new Set(e.map(function(a){return a.state}))).sort()},availableDates:function(){for(var t=[],dt=new Date(Math.min.apply(Math,Object(l.a)(this.bidenPollsOnly.map(function(a){return a.medianDate})))),e=new Date(Math.max.apply(Math,Object(l.a)(this.bidenPollsOnly.map(function(a){return a.medianDate}))));dt<=e;)t.push(new Date(dt)),dt.setDate(dt.getDate()+1);return t.push(new Date(dt).getTime()),t.map(function(a){return new Date(a).toLocaleDateString()})},availableDateMarks:function(){var t=[],e=this.availableDates.length/7,n=0;for(t.push(this.availableDates[0]);n<this.availableDates.length;)n+=e,t.push(this.availableDates.slice(n,n+1)[0]);return t.push(this.availableDates.slice(-1)[0]),t},bidenPollsOnly:function(){var t=this,e=Object(l.a)(new Set(this.pollsMapped.filter(function(a){return"Biden"==a.answer}).map(function(a){return a.question_id}))),n=this.pollsMapped.filter(function(a){return"DEM"==a.party&&t.topCandidates.map(function(a){return a.answer}).includes(a.answer)&&e.includes(a.question_id)});return n},bidenPollsOnlyStateFiltered:function(){var t=this;return this.bidenPollsOnly.filter(function(a){return t.selectedStates.includes(a.state)})},availableCandidates:function(){var t=this,e=Object(l.a)(new Set(this.pollsMapped.filter(function(a){return"Biden"==a.answer}).map(function(a){return a.question_id}))),n=this.pollsMapped.filter(function(a){return"DEM"==a.party&&e.includes(a.question_id)}),r=Object(l.a)(new Set(n.map(function(a){return a.answer})));r=r.map(function(a){return{answer:a,total:0,count:0,avg:0}});var o=!0,c=!1,d=void 0;try{for(var h,f=function(){var e=h.value;n.filter(function(a){return a.answer==e.answer&&t.dateDiff(a.medianDate,new Date)<14}).forEach(function(a){e.total+=a.pct,e.count+=1,e.avg=e.total/e.count})},j=r[Symbol.iterator]();!(o=(h=j.next()).done);o=!0)f()}catch(t){c=!0,d=t}finally{try{o||null==j.return||j.return()}finally{if(c)throw d}}return r.sort(function(a,b){return b.avg-a.avg})},pollsMapped:function(){var t=this;return this.fiveThirtyEightDataset.map(function(a){var e=new Date(a.start_date).getTime()+(new Date(a.end_date).getTime()-new Date(a.start_date).getTime())/2,n=1.96*Math.sqrt(a.pct/100*(1-a.pct/100)/a.sample_size)*100,r=t.pollsterRatings.find(function(b){return b.Pollster==a.pollster}),l=6400*(-2^n+(t.globalAverage+!r?0:r["Predictive Plus-Minus"]))/(6400*(-2^n+t.globalAverage));return{answer:a.answer,pct:t.round(a.pct/100,4),state:a.state,question_id:a.question_id,medianDate:new Date(e),pollWeight:l,party:a.party}})},pollScatter:function(){var t=this,e=[],n=!0,r=!1,l=void 0;try{for(var o,c=function(){var n=o.value;e.push({type:"scatter",label:n.answer,backgroundColor:n.color.light,borderColor:n.color.light,data:t.bidenPollsOnly.filter(function(a){return a.answer==n.answer}).map(function(a){return{x:a.medianDate,y:t.selectedStates.includes(a.state)?a.pct:null}}),fill:!1,showLine:!1})},d=this.topCandidates[Symbol.iterator]();!(n=(o=d.next()).done);n=!0)c()}catch(t){r=!0,l=t}finally{try{n||null==d.return||d.return()}finally{if(r)throw l}}return{datasets:e}},pollsWeighted:function(){for(var t=[],dt=new Date(Math.min.apply(Math,Object(l.a)(this.bidenPollsOnly.map(function(a){return a.medianDate})))),e=new Date(Math.max.apply(Math,Object(l.a)(this.bidenPollsOnly.map(function(a){return a.medianDate}))));dt<=e;)t.push(new Date(dt)),dt.setDate(dt.getDate()+1);t.push(new Date(dt));for(var n={},r=0,o=t;r<o.length;r++){var c=o[r],d=!0,h=!1,f=void 0;try{for(var j,m=this.topCandidates[Symbol.iterator]();!(d=(j=m.next()).done);d=!0){var v=j.value;n[v.answer]||(n[v.answer]={}),n[v.answer][c]={netPct:0,netWt:0,date:c}}}catch(t){h=!0,f=t}finally{try{d||null==m.return||m.return()}finally{if(h)throw f}}var y=!0,w=!1,D=void 0;try{for(var k,C=this.bidenPollsOnlyStateFiltered[Symbol.iterator]();!(y=(k=C.next()).done);y=!0){var S=k.value,M=Math.floor((c-S.medianDate)/864e5),O=Math.pow(.5,M/this.decayFactor)*S.pollWeight;O=O<this.minWeight?0:O,O=M<0?0:O,n[S.answer][c].netPct+=O*S.pct,n[S.answer][c].netWt+=O}}catch(t){w=!0,D=t}finally{try{y||null==C.return||C.return()}finally{if(w)throw D}}}this.setWeightedDataURL(window.URL.createObjectURL(new Blob([JSON.stringify(n)],{type:"application/json"})));var _=[],x=!0,R=!1,z=void 0;try{for(var W,P=this.topCandidates[Symbol.iterator]();!(x=(W=P.next()).done);x=!0){var L=W.value;_.push({type:"scatter",label:L.answer,backgroundColor:L.color.dark,borderColor:L.color.dark,data:Object.values(n[L.answer]).map(function(a){return{x:a.date,y:0==a.netWt||0==a.netPct?null:a.netPct/a.netWt}}),pointRadius:0,fill:!1})}}catch(t){R=!0,z=t}finally{try{x||null==P.return||P.return()}finally{if(R)throw z}}return{datasets:_}},pollsScatterAndWeighted:function(){return{datasets:this.pollsWeighted.datasets.concat(this.pollScatter.datasets)}},pollsScatterAndWeightedDateFiltered:function(){var t=this,e=JSON.parse(JSON.stringify(this.pollsScatterAndWeighted));return e.datasets.forEach(function(a){a.data=a.data.filter(function(b){return(!t.dateRange[0]||t.dateDiff(t.dateRange[0],b.x)>=0)&&(!t.dateRange[1]||t.dateDiff(b.x,t.dateRange[1])>=0)})}),e}},asyncData:function(){var t=Object(r.a)(regeneratorRuntime.mark(function t(e){var n,r,l,c,d;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.$axios,t.next=3,n({method:"get",url:"https://warm-lake-79107.herokuapp.com/https://projects.fivethirtyeight.com/polls-page/president_primary_polls.csv"});case 3:return r=t.sent,t.next=6,o().fromString(r.data);case 6:return l=t.sent,t.next=9,n({method:"get",url:"https://warm-lake-79107.herokuapp.com/https://raw.githubusercontent.com/fivethirtyeight/data/master/pollster-ratings/pollster-ratings.csv"});case 9:return c=t.sent,t.next=12,o().fromString(c.data);case 12:return d=t.sent,t.abrupt("return",{fiveThirtyEightDataset:l,jsonURL:window.URL.createObjectURL(new Blob([JSON.stringify(l)],{type:"application/json"})),pollsterRatings:d,pollstersURL:window.URL.createObjectURL(new Blob([JSON.stringify(d)],{type:"application/json"}))});case 14:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),mounted:function(){this.selectedCandidates=this.availableCandidates.slice(0,7),this.dateRange=[this.availableDates[0],this.availableDates.slice(-1)[0]]},methods:{dateDiff:function(t,e){return Math.floor((new Date(e)-new Date(t))/864e5)},shuffleArray:function(t){for(var i=t.length-1;i>0;i--){var e=Math.floor(Math.random()*(i+1)),n=[t[e],t[i]];t[i]=n[0],t[e]=n[1]}return t},setWeightedDataURL:function(t){this.weightedDataURL=t},randomVal:function(t,e){return Math.floor(Math.random()*(e-t)+1)+t},round:function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)},generateHslColors:function(t){for(var e=[],n=Math.trunc(360/t),i=0;i<t;i++){var r=i*n,s=this.randomVal(30,95);e.push({light:"hsl(".concat(r,", ").concat(s,"%,  80%)"),dark:"hsl(".concat(r,", ").concat(s,"%,  40%)")})}return e}}}),w=Object(m.a)(y,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"hero"},[n("section",{staticClass:"hero-body"},[n("div",{staticClass:"level"},[n("div",{staticClass:"level-item"},[n("nuxt-link",{staticClass:"button is-outlined is-primary",attrs:{to:"/"}},[t._v("\n          Home\n        ")])],1)]),t._v(" "),n("div",{staticClass:"columns is-centered"},[n("div",{staticClass:"column is-narrow"},[n("b-field",{attrs:{label:"States"}},[n("b-select",{staticClass:"is-small",attrs:{multiple:"","native-size":"6"},model:{value:t.selectedStates,callback:function(e){t.selectedStates=e},expression:"selectedStates"}},t._l(t.availableStates,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n              "+t._s(""==e?"U.S.":e)+"\n            ")])}),0)],1),t._v(" "),n("b-field",{staticClass:"is-small",attrs:{label:"Minimum Weight"}},[n("b-select",{staticClass:"is-small",model:{value:t.minWeight,callback:function(e){t.minWeight=e},expression:"minWeight"}},t._l(t.availableMinWeights,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n              "+t._s(e.toFixed(2))+"\n            ")])}),0)],1),t._v(" "),n("b-field",{attrs:{label:"Half Life"}},[n("b-select",{staticClass:"is-small",model:{value:t.decayFactor,callback:function(e){t.decayFactor=e},expression:"decayFactor"}},t._l(t.availableDecayFactors,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n              "+t._s(e)+"\n            ")])}),0)],1)],1),t._v(" "),n("div",{staticClass:"column is-narrow"},[n("b-field",{attrs:{label:"Candidates"}},[n("b-select",{staticClass:"is-small",attrs:{multiple:"","native-size":"10"},model:{value:t.selectedCandidates,callback:function(e){t.selectedCandidates=e},expression:"selectedCandidates"}},t._l(t.availableCandidates,function(e,r){return n("option",{key:r,domProps:{value:e}},[t._v("\n              "+t._s(e.answer)+"\n            ")])}),0)],1)],1),t._v(" "),n("div",{staticClass:"column is-6"},[n("bar-chart",{ref:"chart",attrs:{"chart-data":t.pollsScatterAndWeightedDateFiltered,options:t.chartOptions}}),t._v(" "),n("vue-slider",{attrs:{data:t.availableDates,marks:t.maybeMarks},model:{value:t.dateRange,callback:function(e){t.dateRange=e},expression:"dateRange"}})],1)])])])},[],!1,null,null,null);e.default=w.exports}}]);